/*
 * This file was generated by the Gradle 'init' task.
 *
 * This project uses @Incubating APIs which are subject to change.
 */

plugins {
    // Apply the groovy Plugin to add support for Groovy.
    id 'groovy'

    // Apply the jacoco cocode coverage plugin
    id 'jacoco'

    // Apply the CheckStyle plugin
    id 'checkstyle'

    // Apply the PMD plugin
    id 'pmd'

    // Apply the SpotBugs plugin
    //id 'com.github.spotbugs'

    // Licensing Plugin
    id 'com.github.hierynomus.license'

    // PITest Gradle Plugin
    // id 'info.solidsoft.pitest' version '1.6.0'

    // google-java-format Gradle Plugin
    // id 'com.github.sherter.google-java-format' version '0.10'

    // Apply the SpotLess plugin
    // id 'com.diffplug.spotless'

    // Apply Gradle Versions Plugin
    id 'com.github.ben-manes.versions'
}

java {
    toolchain {
        languageVersion.set(JavaLanguageVersion.of(19))
    }
}

repositories {
    // Use Maven Central for resolving dependencies.
    mavenCentral()
}

dependencies {
    constraints {
        // Define dependency versions as constraints
        implementation 'org.apache.commons:commons-text:1.10.0'

        implementation 'org.codehaus.groovy:groovy-all:3.0.13'
    }

    // Use the latest Groovy version for building this library
    implementation 'org.codehaus.groovy:groovy-all'
    testImplementation 'org.spockframework:spock-core:2.0-groovy-3.0'
    testImplementation 'org.junit.jupiter:junit-jupiter-api:5.9.1'

//    spotbugsPlugin 'com.h3xstream.findsecbugs:findsecbugs-plugin:1.12.0'

    // Slf4J Logger
    implementation 'org.slf4j:slf4j-api:2.0.9'
    implementation 'ch.qos.logback:logback-classic:1.4.11'
}

test {
    // Use JUnit Jupiter test framework
    useJUnitPlatform()
    finalizedBy jacocoTestReport
}

check.dependsOn jacocoTestCoverageVerification

jacoco {
    toolVersion = '0.8.9'
    reportsDirectory = file("$buildDir/jacoco")
}

jacocoTestReport {
    dependsOn test
    reports {
        html.outputLocation = layout.buildDirectory.dir('jacocoHtml')
    }
}

jacocoTestCoverageVerification {
    violationRules {
        rule {
            limit {
                counter = 'LINE'
                value = 'COVEREDRATIO'
                minimum = 0.85
            }
        }
    }
}

license {
    header = project.file('LICENSE')
}

//pitest {
//    threads = 4
//    outputFormats = ['XML', 'HTML']
//    timestampedReports = false
//    junit5PluginVersion = '0.15'
//}

//spotbugs {
//    toolVersion = '4.7.3'
//}
//
//spotbugsMain {
//    reports {
//        html {
//            enabled = true
//            destination = file("$buildDir/reports/spotbugs/main/spotbugs.html")
//            stylesheet = 'fancy-hist.xsl'
//        }
//    }
//}

pmd {
    consoleOutput = true
    toolVersion = '6.21.0'
    rulesMinimumPriority = 5
    ruleSets = [
        'category/java/errorprone.xml',
        'category/java/bestpractices.xml'
    ]
}

checkstyle {
    toolVersion '10.3.3'
    configFile file('${rootDir}/config/checkstyle/checkstyle.xml')
}

checkstyleMain {
    include '**/*.groovy'
}

//spotless {
//    ratchetFrom 'origin/develop'
//
//    format 'misc', {
//        target '*.gradle', '*.md', '.gitignore'
//
//        trimTrailingWhitespace()
//        indentWithSpaces(4)
//        endWithNewline()
//    }
//
//    java {
//        importOrder()
//        removeUnusedImports()
//        googleJavaFormat().aosp().reflowLongStrings()
//        formatAnnotations()
//        licenseHeader '''\
///* MIT License
// *
// * SiliconCode AutoMT - Utilities
// * Copyright (c) $YEAR SiliconCode, LLC and Isaac Griffith, PhD
// *
// * Permission is hereby granted, free of charge, to any person obtaining a copy
// * of this software and associated documentation files (the "Software"), to deal
// * in the Software without restriction, including without limitation the rights
// * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
// * copies of the Software, and to permit persons to whom the Software is
// * furnished to do so, subject to the following conditions:
// *
// * The above copyright notice and this permission notice shall be included in all
// * copies or substantial portions of the Software.
// *
// * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
// * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
// * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
// * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
// * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
// * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
// * SOFTWARE.
// */
//'''
//    }
//
//    groovy {
//        importOrder()
//        //removeUnusedImports()
//        //googleJavaFormat().aosp().reflowLongStrings()
//        //formatAnnotations()
//        greclipse()
//        licenseHeader '''\
///* MIT License
// *
// * SiliconCode AutoMT - Utilities
// * Copyright (c) $YEAR SiliconCode, LLC and Isaac Griffith, PhD
// *
// * Permission is hereby granted, free of charge, to any person obtaining a copy
// * of this software and associated documentation files (the "Software"), to deal
// * in the Software without restriction, including without limitation the rights
// * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
// * copies of the Software, and to permit persons to whom the Software is
// * furnished to do so, subject to the following conditions:
// *
// * The above copyright notice and this permission notice shall be included in all
// * copies or substantial portions of the Software.
// *
// * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
// * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
// * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
// * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
// * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
// * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
// * SOFTWARE.
// */
//'''
//    }

//    groovyGradle {
//        target '*.gradle'
//        //greclipse()
//    }
//}
